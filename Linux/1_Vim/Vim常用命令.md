# Vim常用命令


[Vim Cheat Sheet](https://vim.rtorr.com)

### 使用`vi`打开或创建文件

`vi filename`: 从文件的开头编辑文件
`vi -r filename`: 恢复对异常退出文件的编辑

在非编辑状态下按`i`进入insecte模式

>
`i` - insert before the cursor
>
>`I` - insert at the beginning of the line
>
>`a` - insert (append) after the cursor

### 退出`vi`编辑器
在非编辑状态按下`:`, 光标会移动屏幕的最低部，这个时候可以输入保存及退出指令

`:w`: 保存当前的编辑内容
`:q`: 退出编辑（不保存）
`:wq`: 保存并退出
`:x`: 保存并退出,只有需要保存的时候才保存
`:q!`: 强制退出

### 光标移动

* `0`: 移动到当前行的第一个字符位置(可能是空格)
* `^`: 移动到当前行的第一个非空格字符位置 
* `$`: 移动到当前行的最后一个字符位置(可能是空格)
* `g_`: 移动到当前行的最后一个非空格字符位置 
* `NG`: 移动到第N行
* `gg`: 相当于1G, 移动到第一行
* `G`: 移动到最后一行
* `%`:  如果光标在 (), {}, [].上,则让光标在之间跳动切换
* `*`: 移动到下一个相同单词的开头
* `tx`: 光标移动到字符x的前面, 相反方向为`T`
* `fx`: 光村移动到字符x上面, 相反方向为`F`
* `cw`: 从当前位置开始删除到下个单词的开头位置

#### 单词的移动
* `w`: 光标移动到当前或下个单词的开头，（仅字母，如有特殊字符像#\,)等切割则为不同的单词）
* `b`: 光标移动到当前或上个单词的开头 （仅字母，如有特殊字符像#\,)等切割则为不同的单词）
* `e`: 移动到当前或下个单词的尾部 （仅字母，如有特殊字符像#\,)等切割则为不同的单词）
* `ge`: 移动到当前或上个单词的尾部 （仅字母，如有特殊字符像#\,)等切割则为不同的单词）
	
	默认单词是由字母组成的, 但有些单词可能包含特殊字符，就可以将‘单词’理解为使用空格分割成的字符串，使用大写的W或者E,B就可以将和字母连接在一起的特殊字符看到一个‘单词’:
	* `W`: 移动到下一个空格后的单词的开头
	* `E`: 移动到下一个空格前单词的结尾
* `%`: 移动到下一个`(`, `{`, `[` , 并在对应的闭合部分切换
* `*`: 移动到下一个和光标下的单词一样的单词开头
* `#`: 移动到上一个和光标下的单词一样的单词开头


### 操作

* `y`: yank复制选中区域
* `yy`: 复制当前行,相当于`ddP`,剪切当前行并复制在当前行
* `p`: 粘贴到当前行的下一行
* `P`: 粘贴到当前行的上一行
* `0y$`: 从一行的开头复制到结尾
* `dG`: 从当前行删除到最后一行
* `d$`: 删除从光标所在位置到行尾（基于移动命令 $）
* `diw`: 删除“光标所在的整个单词内容”（不包含周围空白）
* `daw`: 删除“包含周围空白的整个单词”（删除单词 + 一个空格）
* `dw`: 删除从光标到下一个词首（基于移动命令 w）
* `gg`+ `dG`: 到首行，然后删除所有行 

#### 撤销及重做

* `u`: undo
* `control+r`: redo
* `.`: 执行上一个操作

#### 搜索

* `/x`: 往文档的前方搜索
* `?x`: 往文档的后方搜索

确定搜索指令pattern，按下回车后执行，按`n`为移动到搜索结果的下一个, `N`为移动到搜索结果的上一个。

#### 替换

* `:s/foo/bar/g`:  当前行
* `:%s/foo/bar/gc`: 全文 `\c`表示大小写不敏感，`\C`表示大小写敏感
* `:5,12s/foo/bar/g`:  5-12行
* `:.,+2s/foo/bar/g`: 当前行`.`与接下来两行+2


`%s/t\((.*)\)\1`: 将t('Plus')替换成'Plus'

#### 翻页

`control+f`: forwad 下一页
`control+b`:  back 上一页

### 文件操作

* `:e`: <path/to/file> → open
* `:w`: → save
* `:saveas`: <path/to/file> → save to <path/to/file>
* `:x, ZZ or :wq`: → save and quit (:x only save if necessary)
* `:q!`: → quit without saving, also: :qa! to quit even if there are modified hidden buffers.
* `:bn`: (resp. :bp) → show next (resp. previous) file (buffer)


## 区块选择

在 Vim 编辑器中，“可视模式”是一种用于选中和操作文本的模式。进入可视模式后，可以通过移动光标来选择一段文本，然后对选中的内容进行复制、删除、缩进等操作。常用进入方式有：v（字符选中）、V（整行选中）、Ctrl+v（块选中）。

### 区块选择

假设现在光标在‘(map (+) ("foo"))’中foo的第一个字母‘o’上面


`control+v`: 开启区块选择


简单介绍一下`<action>a<object>` 和 `<action>i<object>`

在 Vim 编辑器中，`<action>a<object>` 和 `<action>i<object>`是文本对象操作的两种模式：

`<action>a<object>`：对"around"（周围）的对象执行操作，包括对象本身及其分隔符。
`<action>i<object>`：对"inside"（内部）的对象执行操作，仅包括对象内容，不包括分隔符。
举例：

da"：删除引号及引号内的所有内容
di"：只删除引号内的内容，保留引号
va)：选中括号及括号内的内容
vi)：只选中括号内的内容，不包括括号
这种设计让你可以精确控制操作范围，提高编辑效率。



## 强大的操作组合


### Vim 不需要多光标编辑功能

* `cgn` 
* 修改可视区域
* etc



`cgn` 是 Vim 中一个非常强大的组合操作：

#### cgn 的含义
- `c` = change（修改）
- `gn` = 向前搜索下一个匹配项并选中

#### 工作流程
1. **先搜索**：使用 `/pattern` 搜索你要修改的内容
2. **使用 cgn**：删除当前匹配项并进入插入模式
3. **输入新内容**：替换为你想要的内容
4. **按 Esc**：退出插入模式
5. **重复操作**：按 `.` 重复修改下一个匹配项

#### 实际示例
```vim
/old_text    # 搜索 "old_text"
cgn          # 删除当前匹配并进入插入模式
new_text     # 输入新内容
Esc          # 退出插入模式
n.           # 跳到下一个匹配项并重复修改
n.           # 继续下一个
```

#### 相关命令
- `cgN` - 修改上一个匹配项
- `dgn` - 删除下一个匹配项
- `vgn` - 选中下一个匹配项

#### 优势
1. **精确控制**：可以逐个确认每次修改
2. **高效重复**：用 `.` 命令快速重复
3. **可视化**：能看到每次要修改的内容
4. **可中断**：随时停止操作

这比 `:%s/old/new/gc` 全局替换更灵活，特别适合需要选择性修改的场景。

